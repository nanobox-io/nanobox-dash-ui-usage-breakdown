!function t(e,s,a){function n(i,c){if(!s[i]){if(!e[i]){var o="function"==typeof require&&require;if(!c&&o)return o(i,!0);if(r)return r(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var l=s[i]={exports:{}};e[i][0].call(l.exports,function(t){var s=e[i][1][t];return n(s?s:t)},l,l.exports,t,e,s,a)}return s[i].exports}for(var r="function"==typeof require&&require,i=0;i<a.length;i++)n(a[i]);return n}({1:[function(t,e,s){var a,n;n=t("./utils"),e.exports=a=function(){function t(t){this.$node=t,this.pieFn=d3.layout.pie().startAngle(0).endAngle(Math.PI).padAngle(.025).sort(null).value(function(t){return t.value}),this.arcFn=d3.svg.arc().innerRadius(this._size/1.35).outerRadius(this._size),this.svg=d3.select(this.$node[0]).append("svg:svg").attr({"class":"gauges",height:this._size,transform:"translate(0, "+this._size+")"})}return t.prototype._size=68,t.prototype.update=function(t){var e,s;return t=n.getDataByMetrics(t),s=this,e=this.svg.selectAll("g.gauge").data(t).enter().append("svg:g").each(function(t,e){var a;return a=d3.select(this),a.attr({"class":"gauge "+t.metric,transform:"translate("+(2*s._size*e+15*e+5)+", 0)"}),a.append("svg:text").text(t.metric).attr({"class":"label",x:s._size,y:s._size-10,"text-anchor":"middle"}),a.selectAll("path").data(s.pieFn(t.data)).enter().append("path").attr({"class":function(t){return t.data.type+" "+t.data.name},d:s.arcFn,transform:"translate("+s._size+", "+s._size+") rotate(-90)"}).each(function(t){return this._curAngle=t})}),this.svg.selectAll("g.gauge").data(t).each(function(t){return d3.select(this).selectAll("path").data(s.pieFn(t.data)).transition().duration(500).attrTween("d",function(t){var e;return e=d3.interpolate(this._curAngle,t),this._curAngle=e(0),function(t){return s.arcFn(e(t))}})})},t}()},{"./utils":3}],2:[function(t,e,s){var a,n,r,i,c=function(t,e){return function(){return t.apply(e,arguments)}};a=t("gauges"),r=t("./utils"),i=t("jade/component"),n=function(){function t(t,e){this.options=null!=e?e:{},this.updateData=c(this.updateData,this),this.options.metrics||(this.options.metrics=["cpu","ram"]),this.$node=$(i({metrics:this.options.metrics})),t.append(this.$node)}return t.prototype.build=function(){return this.gauges=new a($(".gauges",this.$node)),this.$table=$("table.services",this.$node),this._updateData()},t.prototype.updateData=function(t){var e;return e=r.getServices(t),e.push({type:"internal",name:"platform",metrics:r.calculatePlatformUsage(t)}),e.push({type:"internal",name:"system",metrics:r.calculateSystemUsage(t)}),e.push({type:"internal",name:"free",metrics:r.calculateUnusedResources(t)}),this.gauges.update(e),this._updateTable(e)},t.prototype._updateTable=function(t){var e;return e=d3.select($("table.services tbody.stats",this.$node).get(0)),e.selectAll("tr").data(t).each(function(t){return d3.select(this).selectAll(".name").text(t.name),d3.select(this).selectAll(".ram").text((100*t.metrics.ram).toPrecision(2)+"%"),d3.select(this).selectAll(".cpu").text((100*t.metrics.cpu).toPrecision(2)+"%")}),e.selectAll("tr").data(t).enter().append("tr").attr("class",function(t){return t.name+" "+t.type}).each(function(t){return d3.select(this).append("td").attr({"class":"icon"}).append("div").attr({"class":"icon-wrap"}).append("img").attr({"class":"shadow-icon","data-src":"hex-"+t.kind,scalable:!0}),d3.select(this).append("td").attr({"class":"stat name"}).text(t.name),d3.select(this).append("td").attr({"class":"stat metric ram"}).text((100*t.metrics.ram).toPrecision(2)+"%"),d3.select(this).append("td").attr({"class":"stat metric cpu"}).text((100*t.metrics.cpu).toPrecision(2)+"%")}),castShadows($("tbody",this.$table))},t.prototype._updateData=function(){return PubSub.publish("STATS.SUBSCRIBE.USAGE_BREAKDOWN",{metrics:this.options.metrics,services:this.options.services,liveHostStats:this.options.liveHostStats,callback:this.updateData})},t}(),window.nanobox||(window.nanobox={}),nanobox.UsageBreakdown=n},{"./utils":3,gauges:1,"jade/component":4}],3:[function(t,e,s){var a;e.exports=a=function(){function t(){}return t.getDataByMetrics=function(t){var e,s,a,n,r,i,c;for(r={},s=0,n=t.length;n>s;s++){e=t[s],i=e.metrics;for(a in i)c=i[a],r[a]||(r[a]=[]),r[a].push({type:e.type,name:e.name,value:c})}return Object.keys(r).map(function(t){return{metric:t,data:r[t]}})},t.getServices=function(t){var e,s,a,n,r;for(r=[],a=t.services,e=0,s=a.length;s>e;e++)n=a[e],"service"===n.type&&r.push(n);return r},t.calculatePlatformUsage=function(t){var e,s,a,n,r;for(a={cpu:0,ram:0},n=t.services,e=0,s=n.length;s>e;e++)r=n[e],"internal"===r.type&&(a.cpu+=r.metrics.cpu,a.ram+=r.metrics.ram);return a},t.calculateSystemUsage=function(t){var e,s,a,n,r,i,c;for(a=[0,0],i=a[0],c=a[1],n=t.services,e=0,s=n.length;s>e;e++)r=n[e],i+=r.metrics.cpu,c+=r.metrics.ram;return{cpu:t.liveHostStats.cpu-i,ram:t.liveHostStats.ram-c}},t.calculateUnusedResources=function(t){var e,s,a,n,r,i,c;for(a=[0,0],i=a[0],c=a[1],n=t.services,e=0,s=n.length;s>e;e++)r=n[e],i+=r.metrics.cpu,c+=r.metrics.ram;return{cpu:t.liveHostStats.cpu-i,ram:t.liveHostStats.ram-c}},t}()},{}],4:[function(t,e,s){e.exports=function(t){var e,s=[],a=t||{};return function(t,a){s.push('<div class="nanobox-dash-ui-usage-breakdown"><div class="component"><div class="gauges"></div><table class="services"><thead class="labels"><tr><th colspan="2"></th>'),function(){var a=t;if("number"==typeof a.length)for(var n=0,r=a.length;r>n;n++){var i=a[n];s.push('<th class="label">'+jade.escape(null==(e=i)?"":e)+"</th>")}else{var r=0;for(var n in a){r++;var i=a[n];s.push('<th class="label">'+jade.escape(null==(e=i)?"":e)+"</th>")}}}.call(this),s.push('</tr></thead><tbody class="stats"></tbody></table></div></div>')}.call(this,"metrics"in a?a.metrics:"undefined"!=typeof metrics?metrics:void 0,"undefined"in a?a.undefined:void 0),s.join("")}},{}]},{},[2]);